<script type="text/javascript">
    document.addEventListener('flAutocompleteReady', function (e) {
        var originalSelectItem = e.detail.flAutocomplete.selectItem;
        e.detail.flAutocomplete.selectItem = function (event, ui) {
            originalSelectItem.call(e.detail.flAutocomplete, event, ui);

            var action = '/search';
            if (App.defaultLanguage !== App.language) {
                action = '/' + App.language + '/search';
            }

            document.getElementById('search-form').setAttribute('action', action);
            var searchForm = e.detail.flAutocomplete.getFormByEventTarget(event);
            searchForm[0].submit();
        };
    }, false);

    window.flSearchSubmit = false;
    window.flSearchSubmitEvent = document.createEvent('Event');
    window.flSearchSubmitEvent.initEvent('fl-search-submit', true, true);
    document.addEventListener('fl-search-submit', function (e) {
        e.stopImmediatePropagation();
        e.preventDefault();

        var action = '/search';
        if (App.defaultLanguage !== App.language) {
            action = '/' + App.language + '/search';
        }

        var searchForm = document.getElementById('search-form')[0];
        searchForm.setAttribute('action', action);
        searchForm.submit();

        return true;
    }, false);

    (function (f,i,n,d,o,l,O,g,I,c){var V=[];var m=f.createElement("style");if(d){V.push(d)}if(c&&I.location.hash.indexOf("#search:")===0){V.push(c)}if(V.length>0){var Z=V.join(",");m.textContent=Z+"{opacity: 0;transition: opacity "+O+" ease-in-out;}."+o+" {opacity: 1 !important;}";I.flRevealContainers=function(){var a=f.querySelectorAll(Z);for(var T=0;T<a.length;T++){a[T].classList.add(o)}};setTimeout(I.flRevealContainers,l)}var W=g+"/static/"+i+"/main.js?usergrouphash="+n;var p=f.createElement("script");p.type="text/javascript";p.async=true;p.src=g+"/static/loader.min.js";var q=f.getElementsByTagName("script")[0];p.setAttribute("data-fl-main",W);q.parentNode.insertBefore(p,q);q.parentNode.insertBefore(m,p)})(document,'{{ shopkey }}','','.{{ navigationContainer }}','fl-reveal',3000,'.3s','//cdn.findologic.com',window,'.{{ searchResultContainer }}');
</script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/svg-injector/1.1.3/svg-injector.min.js"></script>

{% if isSearchPage or activeOnCatPage %}
    <script src="{{ plugin_path("Findologic") }}/js/dist/filters-component-min.js"></script>
{% endif %}

<script>
    $(function() {
        SVGInjector($('img.fl-svg'));
    });
</script>
