language: php

php:
  - '7.1'
  - '7.2'

sudo: required

stages:
  - check-local-changes

cache:
  directories:
    - ${HOME}/.composer/cache/files

before_install:
  - nvm install 6.10
  - npm install
  - sudo npm run build

install:
  - curl -sS https://getcomposer.org/installer | php
  - php composer.phar --version
  - php composer.phar install

script:
  - php vendor/bin/phpunit -c tests/phpunit.xml

jobs:
  include:
    - stage: check-local-changes
      install: skip
      before_script: skip
      script: sudo ./tests/check-local-changes.sh
